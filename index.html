<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MediScript Enterprise - Complete Healthcare Management</title>
  <link rel="icon" href="https://nyc3.digitaloceanspaces.com/bhindi-drive/files/cab453ed-7d3e-4dfa-9012-038dbc50c1c5/2025-12-07T15-33-38-867Z-c50befdf-chat-image-1765121618851-0.jpg">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Roboto', -apple-system, sans-serif;
      background: #f8f9fa;
      color: #333;
    }
    
    :root {
      --primary: #14BEF0;
      --primary-dark: #0FA8D6;
      --success: #3AAA35;
      --danger: #E74C3C;
      --warning: #F39C12;
      --purple: #9B59B6;
      --text-dark: #2C3E50;
      --text-light: #7F8C8D;
      --border: #E0E0E0;
    }
    
    .header {
      background: white;
      border-bottom: 1px solid var(--border);
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.04);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }
    
    .sidebar {
      width: 260px;
      background: white;
      border-right: 1px solid var(--border);
      padding: 24px 0;
      height: calc(100vh - 65px);
      position: sticky;
      top: 65px;
      overflow-y: auto;
    }
    
    .nav-item {
      padding: 14px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--text-dark);
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
      font-size: 15px;
    }
    
    .nav-item:hover {
      background: #F0F9FF;
      color: var(--primary);
    }
    
    .nav-item.active {
      background: #E6F7FF;
      color: var(--primary);
      border-left: 3px solid var(--primary);
    }
    
    .card {
      background: white;
      border-radius: 8px;
      padding: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      border: 1px solid var(--border);
      margin-bottom: 20px;
    }
    
    .stat-card {
      background: white;
      border-radius: 8px;
      padding: 24px;
      border: 1px solid var(--border);
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      transition: all 0.2s;
      cursor: pointer;
    }
    
    .stat-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
      transform: translateY(-2px);
    }
    
    .stat-number {
      font-size: 32px;
      font-weight: 700;
      color: var(--text-dark);
      margin: 8px 0;
    }
    
    .stat-label {
      font-size: 14px;
      color: var(--text-light);
      font-weight: 500;
    }
    
    .btn {
      padding: 12px 24px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 14px;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: var(--primary-dark); }
    .btn-success { background: var(--success); color: white; }
    .btn-danger { background: var(--danger); color: white; }
    .btn-outline { background: white; color: var(--primary); border: 2px solid var(--primary); }
    
    .form-group { margin-bottom: 20px; }
    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
    }
    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 14px;
      transition: all 0.2s;
    }
    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(20, 190, 240, 0.1);
    }
    
    table { width: 100%; border-collapse: collapse; }
    th {
      background: #F8F9FA;
      padding: 14px 16px;
      text-align: left;
      font-weight: 600;
      font-size: 13px;
      color: var(--text-dark);
      border-bottom: 2px solid var(--border);
    }
    td {
      padding: 16px;
      border-bottom: 1px solid #F0F0F0;
      font-size: 14px;
    }
    tr:hover td { background: #F8F9FA; }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      overflow-y: auto;
    }
    .modal.active { display: flex; }
    .modal-content {
      background: white;
      border-radius: 8px;
      padding: 32px;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      width: 90%;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      margin: 20px;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }
    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-dark);
    }
    .close-btn {
      font-size: 28px;
      color: var(--text-light);
      cursor: pointer;
      background: none;
      border: none;
    }
    
    .badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      display: inline-block;
    }
    .badge-primary { background: #E6F7FF; color: var(--primary); }
    .badge-success { background: #E8F5E9; color: var(--success); }
    .badge-warning { background: #FFF3E0; color: var(--warning); }
    .badge-danger { background: #FFEBEE; color: var(--danger); }
    
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      margin-top: 16px;
    }
    .calendar-day {
      aspect-ratio: 1;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }
    .calendar-day:hover {
      background: #F0F9FF;
      border-color: var(--primary);
    }
    .calendar-day.today {
      background: var(--primary);
      color: white;
      font-weight: 700;
    }
    .calendar-day.has-appointments {
      background: #E8F5E9;
    }
    .appointment-count {
      position: absolute;
      bottom: 4px;
      right: 4px;
      background: var(--danger);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
    }
    
    .time-slot {
      padding: 12px;
      border: 2px solid var(--border);
      border-radius: 6px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .time-slot:hover {
      border-color: var(--primary);
      background: #F0F9FF;
    }
    .time-slot.booked {
      background: #FFEBEE;
      border-color: var(--danger);
      cursor: not-allowed;
    }
    
    .invoice-item {
      display: flex;
      justify-content: space-between;
      padding: 12px;
      border-bottom: 1px solid var(--border);
    }
    
    .stock-alert {
      background: #FFF3E0;
      border-left: 4px solid var(--warning);
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 4px;
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      margin: 20px 0;
    }
    
    .page-title {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 4px;
    }
    .page-subtitle {
      font-size: 14px;
      color: var(--text-light);
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <!-- Appointment Modal -->
  <div id="appointmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">üìÖ Book Appointment</h2>
        <button class="close-btn" onclick="closeModal('appointmentModal')">&times;</button>
      </div>
      <form onsubmit="saveAppointment(event)">
        <div class="form-group">
          <label class="form-label">Patient *</label>
          <select id="apptPatient" class="form-input" required></select>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Date *</label>
            <input type="date" id="apptDate" class="form-input" required>
          </div>
          <div class="form-group">
            <label class="form-label">Time *</label>
            <input type="time" id="apptTime" class="form-input" required>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Reason for Visit</label>
          <textarea id="apptReason" class="form-input" rows="2"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Type</label>
          <select id="apptType" class="form-input">
            <option>Consultation</option>
            <option>Follow-up</option>
            <option>Emergency</option>
          </select>
        </div>
        <div class="flex gap-3 mt-6">
          <button type="submit" class="btn btn-success flex-1">Book Appointment</button>
          <button type="button" onclick="closeModal('appointmentModal')" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Billing Modal -->
  <div id="billingModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">üí∞ Generate Invoice</h2>
        <button class="close-btn" onclick="closeModal('billingModal')">&times;</button>
      </div>
      <form onsubmit="generateInvoice(event)">
        <div class="form-group">
          <label class="form-label">Patient *</label>
          <select id="billPatient" class="form-input" required></select>
        </div>
        <div class="form-group">
          <label class="form-label">Services</label>
          <div id="servicesList">
            <div class="invoice-item">
              <div>
                <input type="text" placeholder="Service name" class="form-input" style="width: 300px; display: inline-block;">
                <input type="number" placeholder="Amount" class="form-input" style="width: 150px; display: inline-block; margin-left: 8px;">
              </div>
              <button type="button" onclick="addService()" class="btn btn-primary">+ Add</button>
            </div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Subtotal</label>
            <input type="number" id="billSubtotal" class="form-input" readonly>
          </div>
          <div class="form-group">
            <label class="form-label">GST (18%)</label>
            <input type="number" id="billGST" class="form-input" readonly>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Total Amount</label>
          <input type="number" id="billTotal" class="form-input" readonly style="font-size: 18px; font-weight: 700;">
        </div>
        <div class="form-group">
          <label class="form-label">Payment Method</label>
          <select id="billPayment" class="form-input">
            <option>Cash</option>
            <option>Card</option>
            <option>UPI</option>
            <option>Insurance</option>
          </select>
        </div>
        <div class="flex gap-3 mt-6">
          <button type="submit" class="btn btn-success flex-1">Generate Invoice</button>
          <button type="button" onclick="closeModal('billingModal')" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Inventory Modal -->
  <div id="inventoryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">üì¶ Add Medicine Stock</h2>
        <button class="close-btn" onclick="closeModal('inventoryModal')">&times;</button>
      </div>
      <form onsubmit="addInventory(event)">
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Medicine Name *</label>
            <input type="text" id="invMedicine" class="form-input" required>
          </div>
          <div class="form-group">
            <label class="form-label">Quantity *</label>
            <input type="number" id="invQuantity" class="form-input" required>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Batch Number</label>
            <input type="text" id="invBatch" class="form-input">
          </div>
          <div class="form-group">
            <label class="form-label">Expiry Date</label>
            <input type="date" id="invExpiry" class="form-input">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Purchase Price</label>
            <input type="number" id="invPrice" class="form-input">
          </div>
          <div class="form-group">
            <label class="form-label">Supplier</label>
            <input type="text" id="invSupplier" class="form-input">
          </div>
        </div>
        <div class="flex gap-3 mt-6">
          <button type="submit" class="btn btn-success flex-1">Add to Inventory</button>
          <button type="button" onclick="closeModal('inventoryModal')" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Patient Modal -->
  <div id="patientModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Register New Patient</h2>
        <button class="close-btn" onclick="closeModal('patientModal')">&times;</button>
      </div>
      <form onsubmit="savePatient(event)">
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">First Name *</label>
            <input type="text" id="patFirstName" class="form-input" required>
          </div>
          <div class="form-group">
            <label class="form-label">Last Name *</label>
            <input type="text" id="patLastName" class="form-input" required>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-4">
          <div class="form-group">
            <label class="form-label">Age *</label>
            <input type="number" id="patAge" class="form-input" required>
          </div>
          <div class="form-group">
            <label class="form-label">Gender *</label>
            <select id="patGender" class="form-input">
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Blood Group</label>
            <select id="patBlood" class="form-input">
              <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
              <option>O+</option><option>O-</option><option>AB+</option><option>AB-</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="form-group">
            <label class="form-label">Phone *</label>
            <input type="tel" id="patPhone" class="form-input" required>
          </div>
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" id="patEmail" class="form-input">
          </div>
        </div>
        <div class="flex gap-3 mt-6">
          <button type="submit" class="btn btn-success flex-1">Save Patient</button>
          <button type="button" onclick="closeModal('patientModal')" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let DB = {
      patients: [
        {id: 'p1', patient_id: 'P001', first_name: 'Rajesh', last_name: 'Kumar', age: 45, gender: 'Male', blood_group: 'O+', phone: '+919876543220', email: 'rajesh@example.com'},
        {id: 'p2', patient_id: 'P002', first_name: 'Priya', last_name: 'Sharma', age: 32, gender: 'Female', blood_group: 'A+', phone: '+919876543221', email: 'priya@example.com'},
        {id: 'p3', patient_id: 'P003', first_name: 'Kumar', last_name: 'Vaibhav', age: 28, gender: 'Male', blood_group: 'A-', phone: '09999456126', email: 'kumar@example.com'}
      ],
      appointments: [
        {id: 'a1', patient_id: 'p1', date: '2025-12-09', time: '10:00', reason: 'Regular checkup', type: 'Consultation', status: 'Scheduled'},
        {id: 'a2', patient_id: 'p2', date: '2025-12-09', time: '11:00', reason: 'Follow-up', type: 'Follow-up', status: 'Scheduled'}
      ],
      invoices: [
        {id: 'inv1', patient_id: 'p1', date: '2025-12-08', services: [{name: 'Consultation', amount: 500}], subtotal: 500, gst: 90, total: 590, payment: 'Cash', status: 'Paid'},
        {id: 'inv2', patient_id: 'p2', date: '2025-12-07', services: [{name: 'Consultation', amount: 500}, {name: 'ECG', amount: 300}], subtotal: 800, gst: 144, total: 944, payment: 'UPI', status: 'Paid'}
      ],
      inventory: [
        {id: 'i1', medicine: 'Paracetamol 650mg', quantity: 500, batch: 'B123', expiry: '2026-12-31', price: 2, supplier: 'MedSupply Co'},
        {id: 'i2', medicine: 'Amoxicillin 500mg', quantity: 50, batch: 'B124', expiry: '2025-12-31', price: 5, supplier: 'MedSupply Co'},
        {id: 'i3', medicine: 'Metformin 500mg', quantity: 200, batch: 'B125', expiry: '2026-06-30', price: 3, supplier: 'PharmaCorp'}
      ],
      notifications: []
    };

    let currentScreen = 'dashboard';
    let charts = {};

    window.openModal = function(id) {
      document.getElementById(id).classList.add('active');
      if (id === 'appointmentModal' || id === 'billingModal') {
        const select = document.getElementById(id === 'appointmentModal' ? 'apptPatient' : 'billPatient');
        select.innerHTML = '<option value="">Select Patient</option>' + DB.patients.map(p => `<option value="${p.id}">${p.patient_id} - ${p.first_name} ${p.last_name}</option>`).join('');
      }
    };

    window.closeModal = function(id) {
      document.getElementById(id).classList.remove('active');
    };

    window.switchScreen = function(screen) {
      currentScreen = screen;
      render();
    };

    window.savePatient = function(e) {
      e.preventDefault();
      const p = {
        id: 'p' + Date.now(),
        patient_id: 'P' + String(DB.patients.length + 1).padStart(3, '0'),
        first_name: document.getElementById('patFirstName').value,
        last_name: document.getElementById('patLastName').value,
        age: parseInt(document.getElementById('patAge').value),
        gender: document.getElementById('patGender').value,
        blood_group: document.getElementById('patBlood').value,
        phone: document.getElementById('patPhone').value,
        email: document.getElementById('patEmail').value
      };
      DB.patients.push(p);
      localStorage.setItem('patients', JSON.stringify(DB.patients));
      
      // Send welcome notification
      DB.notifications.push({
        id: 'n' + Date.now(),
        patient_id: p.id,
        type: 'welcome',
        message: `Welcome to MediScript! Your Patient ID is ${p.patient_id}`,
        date: new Date().toISOString()
      });
      
      closeModal('patientModal');
      alert('‚úÖ Patient registered! Welcome notification sent.');
      render();
    };

    window.saveAppointment = function(e) {
      e.preventDefault();
      const appt = {
        id: 'a' + Date.now(),
        patient_id: document.getElementById('apptPatient').value,
        date: document.getElementById('apptDate').value,
        time: document.getElementById('apptTime').value,
        reason: document.getElementById('apptReason').value,
        type: document.getElementById('apptType').value,
        status: 'Scheduled'
      };
      DB.appointments.push(appt);
      localStorage.setItem('appointments', JSON.stringify(DB.appointments));
      
      // Send appointment confirmation
      DB.notifications.push({
        id: 'n' + Date.now(),
        patient_id: appt.patient_id,
        type: 'appointment',
        message: `Appointment confirmed for ${appt.date} at ${appt.time}`,
        date: new Date().toISOString()
      });
      
      closeModal('appointmentModal');
      alert('‚úÖ Appointment booked! Confirmation sent to patient.');
      render();
    };

    window.generateInvoice = function(e) {
      e.preventDefault();
      const subtotal = parseFloat(document.getElementById('billSubtotal').value) || 0;
      const gst = parseFloat(document.getElementById('billGST').value) || 0;
      const total = parseFloat(document.getElementById('billTotal').value) || 0;
      
      const invoice = {
        id: 'inv' + Date.now(),
        patient_id: document.getElementById('billPatient').value,
        date: new Date().toISOString().split('T')[0],
        services: [{name: 'Consultation', amount: subtotal}],
        subtotal: subtotal,
        gst: gst,
        total: total,
        payment: document.getElementById('billPayment').value,
        status: 'Paid'
      };
      DB.invoices.push(invoice);
      localStorage.setItem('invoices', JSON.stringify(DB.invoices));
      
      closeModal('billingModal');
      alert('‚úÖ Invoice generated successfully!');
      render();
    };

    window.addInventory = function(e) {
      e.preventDefault();
      const item = {
        id: 'i' + Date.now(),
        medicine: document.getElementById('invMedicine').value,
        quantity: parseInt(document.getElementById('invQuantity').value),
        batch: document.getElementById('invBatch').value,
        expiry: document.getElementById('invExpiry').value,
        price: parseFloat(document.getElementById('invPrice').value) || 0,
        supplier: document.getElementById('invSupplier').value
      };
      DB.inventory.push(item);
      localStorage.setItem('inventory', JSON.stringify(DB.inventory));
      
      closeModal('inventoryModal');
      alert('‚úÖ Medicine added to inventory!');
      render();
    };

    function createChart(canvasId, type, data, options) {
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      if (charts[canvasId]) charts[canvasId].destroy();
      charts[canvasId] = new Chart(ctx, { type, data, options });
    }

    function render() {
      const app = document.getElementById('app');
      
      const header = `<div class="header">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <rect width="32" height="32" rx="8" fill="#14BEF0"/>
            <path d="M16 8L16 24M8 16L24 16" stroke="white" stroke-width="3" stroke-linecap="round"/>
          </svg>
          <span>MediScript Enterprise</span>
        </div>
        <div class="flex items-center gap-4">
          <div class="text-right">
            <div style="font-weight: 600; font-size: 14px;">Dr. Rajesh Sharma</div>
            <div style="font-size: 12px; color: var(--text-light);">MBBS, MD</div>
          </div>
          <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-weight: 700;">RS</div>
        </div>
      </div>`;

      const sidebar = `<div class="sidebar">
        <div class="nav-item ${currentScreen === 'dashboard' ? 'active' : ''}" onclick="switchScreen('dashboard')">
          <span>üìä</span><span>Dashboard</span>
        </div>
        <div class="nav-item ${currentScreen === 'appointments' ? 'active' : ''}" onclick="switchScreen('appointments')">
          <span>üìÖ</span><span>Appointments</span>
        </div>
        <div class="nav-item ${currentScreen === 'patients' ? 'active' : ''}" onclick="switchScreen('patients')">
          <span>üë•</span><span>Patients</span>
        </div>
        <div class="nav-item ${currentScreen === 'billing' ? 'active' : ''}" onclick="switchScreen('billing')">
          <span>üí∞</span><span>Billing</span>
        </div>
        <div class="nav-item ${currentScreen === 'inventory' ? 'active' : ''}" onclick="switchScreen('inventory')">
          <span>üì¶</span><span>Inventory</span>
        </div>
        <div class="nav-item ${currentScreen === 'analytics' ? 'active' : ''}" onclick="switchScreen('analytics')">
          <span>üìà</span><span>Analytics</span>
        </div>
        <div class="nav-item ${currentScreen === 'notifications' ? 'active' : ''}" onclick="switchScreen('notifications')">
          <span>üîî</span><span>Notifications</span>
        </div>
      </div>`;

      let content = '';

      if (currentScreen === 'dashboard') {
        const todayRevenue = DB.invoices.filter(i => i.date === new Date().toISOString().split('T')[0]).reduce((sum, i) => sum + i.total, 0);
        const todayAppointments = DB.appointments.filter(a => a.date === new Date().toISOString().split('T')[0]).length;
        const lowStock = DB.inventory.filter(i => i.quantity < 100).length;
        
        content = `
          <div style="padding: 32px;">
            <div style="margin-bottom: 24px;">
              <h1 class="page-title">Dashboard</h1>
              <p class="page-subtitle">Enterprise Healthcare Management</p>
            </div>
            
            <div class="grid grid-cols-4 gap-6 mb-8">
              <div class="stat-card">
                <div class="stat-label">Today's Revenue</div>
                <div class="stat-number">‚Çπ${todayRevenue}</div>
                <div style="font-size: 13px; color: var(--success); font-weight: 600;">+12% from yesterday</div>
              </div>
              <div class="stat-card" onclick="switchScreen('appointments')">
                <div class="stat-label">Today's Appointments</div>
                <div class="stat-number">${todayAppointments}</div>
                <div style="font-size: 13px; color: var(--primary); font-weight: 600;">${DB.appointments.length} total</div>
              </div>
              <div class="stat-card" onclick="switchScreen('patients')">
                <div class="stat-label">Total Patients</div>
                <div class="stat-number">${DB.patients.length}</div>
                <div style="font-size: 13px; color: var(--success); font-weight: 600;">+2 this week</div>
              </div>
              <div class="stat-card" onclick="switchScreen('inventory')">
                <div class="stat-label">Low Stock Alerts</div>
                <div class="stat-number">${lowStock}</div>
                <div style="font-size: 13px; color: var(--warning); font-weight: 600;">Needs attention</div>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-6">
              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 20px;">Quick Actions</h3>
                <div class="grid grid-cols-2 gap-3">
                  <button onclick="openModal('appointmentModal')" class="btn btn-primary" style="justify-content: center;">
                    üìÖ Book Appointment
                  </button>
                  <button onclick="openModal('patientModal')" class="btn btn-success" style="justify-content: center;">
                    üë§ New Patient
                  </button>
                  <button onclick="openModal('billingModal')" class="btn btn-primary" style="justify-content: center;">
                    üí∞ Generate Invoice
                  </button>
                  <button onclick="openModal('inventoryModal')" class="btn btn-success" style="justify-content: center;">
                    üì¶ Add Stock
                  </button>
                </div>
              </div>

              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 20px;">Today's Appointments</h3>
                ${DB.appointments.filter(a => a.date === new Date().toISOString().split('T')[0]).map(a => {
                  const p = DB.patients.find(pt => pt.id === a.patient_id);
                  return `<div style="padding: 12px; background: #F8F9FA; border-radius: 6px; margin-bottom: 8px;">
                    <div style="font-weight: 600;">${a.time} - ${p.first_name} ${p.last_name}</div>
                    <div style="font-size: 13px; color: var(--text-light);">${a.reason}</div>
                  </div>`;
                }).join('') || '<p style="text-align: center; color: var(--text-light); padding: 20px;">No appointments today</p>'}
              </div>
            </div>
          </div>
        `;
      } else if (currentScreen === 'appointments') {
        content = `
          <div style="padding: 32px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
              <div>
                <h1 class="page-title">Appointments</h1>
                <p class="page-subtitle">Manage patient appointments</p>
              </div>
              <button onclick="openModal('appointmentModal')" class="btn btn-primary">
                üìÖ Book Appointment
              </button>
            </div>

            <div class="card">
              <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Calendar View</h3>
              <div class="calendar">
                ${Array.from({length: 35}, (_, i) => {
                  const day = i - 5;
                  const date = new Date();
                  date.setDate(date.getDate() + day);
                  const dateStr = date.toISOString().split('T')[0];
                  const appts = DB.appointments.filter(a => a.date === dateStr);
                  const isToday = day === 0;
                  
                  return `<div class="calendar-day ${isToday ? 'today' : ''} ${appts.length > 0 ? 'has-appointments' : ''}">
                    <div style="font-size: 12px; font-weight: 600;">${date.getDate()}</div>
                    ${appts.length > 0 ? `<div class="appointment-count">${appts.length}</div>` : ''}
                  </div>`;
                }).join('')}
              </div>
            </div>

            <div class="card" style="margin-top: 20px;">
              <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Upcoming Appointments</h3>
              <table>
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Patient</th>
                    <th>Reason</th>
                    <th>Type</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  ${DB.appointments.map(a => {
                    const p = DB.patients.find(pt => pt.id === a.patient_id);
                    return `<tr>
                      <td>${a.date}</td>
                      <td>${a.time}</td>
                      <td style="font-weight: 600;">${p.first_name} ${p.last_name}</td>
                      <td>${a.reason}</td>
                      <td><span class="badge badge-primary">${a.type}</span></td>
                      <td><span class="badge badge-success">${a.status}</span></td>
                    </tr>`;
                  }).join('')}
                </tbody>
              </table>
            </div>
          </div>
        `;
      } else if (currentScreen === 'patients') {
        content = `
          <div style="padding: 32px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
              <div>
                <h1 class="page-title">Patients</h1>
                <p class="page-subtitle">Manage patient records</p>
              </div>
              <button onclick="openModal('patientModal')" class="btn btn-primary">
                üë§ Register Patient
              </button>
            </div>

            <div class="card">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Age</th>
                    <th>Gender</th>
                    <th>Blood Group</th>
                    <th>Contact</th>
                  </tr>
                </thead>
                <tbody>
                  ${DB.patients.map(p => `
                    <tr>
                      <td><span class="badge badge-primary">${p.patient_id}</span></td>
                      <td style="font-weight: 600;">${p.first_name} ${p.last_name}</td>
                      <td>${p.age}Y</td>
                      <td>${p.gender}</td>
                      <td><span class="badge badge-danger">${p.blood_group}</span></td>
                      <td>${p.phone}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </div>
        `;
      } else if (currentScreen === 'billing') {
        const totalRevenue = DB.invoices.reduce((sum, i) => sum + i.total, 0);
        const pendingAmount = DB.invoices.filter(i => i.status === 'Pending').reduce((sum, i) => sum + i.total, 0);
        
        content = `
          <div style="padding: 32px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
              <div>
                <h1 class="page-title">Billing & Invoicing</h1>
                <p class="page-subtitle">Financial management</p>
              </div>
              <button onclick="openModal('billingModal')" class="btn btn-primary">
                üí∞ Generate Invoice
              </button>
            </div>

            <div class="grid grid-cols-3 gap-6 mb-8">
              <div class="stat-card">
                <div class="stat-label">Total Revenue</div>
                <div class="stat-number">‚Çπ${totalRevenue}</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Pending Amount</div>
                <div class="stat-number">‚Çπ${pendingAmount}</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Total Invoices</div>
                <div class="stat-number">${DB.invoices.length}</div>
              </div>
            </div>

            <div class="card">
              <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Recent Invoices</h3>
              <table>
                <thead>
                  <tr>
                    <th>Invoice ID</th>
                    <th>Date</th>
                    <th>Patient</th>
                    <th>Amount</th>
                    <th>Payment</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  ${DB.invoices.map(inv => {
                    const p = DB.patients.find(pt => pt.id === inv.patient_id);
                    return `<tr>
                      <td><span class="badge badge-primary">${inv.id.toUpperCase()}</span></td>
                      <td>${inv.date}</td>
                      <td style="font-weight: 600;">${p.first_name} ${p.last_name}</td>
                      <td style="font-weight: 700;">‚Çπ${inv.total}</td>
                      <td>${inv.payment}</td>
                      <td><span class="badge badge-success">${inv.status}</span></td>
                    </tr>`;
                  }).join('')}
                </tbody>
              </table>
            </div>
          </div>
        `;
      } else if (currentScreen === 'inventory') {
        const lowStockItems = DB.inventory.filter(i => i.quantity < 100);
        
        content = `
          <div style="padding: 32px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
              <div>
                <h1 class="page-title">Inventory Management</h1>
                <p class="page-subtitle">Medicine stock control</p>
              </div>
              <button onclick="openModal('inventoryModal')" class="btn btn-primary">
                üì¶ Add Stock
              </button>
            </div>

            ${lowStockItems.length > 0 ? `
              <div class="card" style="margin-bottom: 20px;">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">‚ö†Ô∏è Low Stock Alerts</h3>
                ${lowStockItems.map(item => `
                  <div class="stock-alert">
                    <strong>${item.medicine}</strong> - Only ${item.quantity} units remaining
                  </div>
                `).join('')}
              </div>
            ` : ''}

            <div class="card">
              <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Current Stock</h3>
              <table>
                <thead>
                  <tr>
                    <th>Medicine</th>
                    <th>Quantity</th>
                    <th>Batch</th>
                    <th>Expiry</th>
                    <th>Price</th>
                    <th>Supplier</th>
                  </tr>
                </thead>
                <tbody>
                  ${DB.inventory.map(item => `
                    <tr>
                      <td style="font-weight: 600;">${item.medicine}</td>
                      <td><span class="badge ${item.quantity < 100 ? 'badge-warning' : 'badge-success'}">${item.quantity}</span></td>
                      <td>${item.batch}</td>
                      <td>${item.expiry}</td>
                      <td>‚Çπ${item.price}</td>
                      <td>${item.supplier}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </div>
        `;
      } else if (currentScreen === 'analytics') {
        content = `
          <div style="padding: 32px;">
            <div style="margin-bottom: 24px;">
              <h1 class="page-title">Analytics & Reports</h1>
              <p class="page-subtitle">Business insights & trends</p>
            </div>

            <div class="grid grid-cols-2 gap-6">
              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Revenue Trend</h3>
                <div class="chart-container">
                  <canvas id="revenueChart"></canvas>
                </div>
              </div>

              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Patient Demographics</h3>
                <div class="chart-container">
                  <canvas id="demographicsChart"></canvas>
                </div>
              </div>

              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Appointment Types</h3>
                <div class="chart-container">
                  <canvas id="appointmentChart"></canvas>
                </div>
              </div>

              <div class="card">
                <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Payment Methods</h3>
                <div class="chart-container">
                  <canvas id="paymentChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        `;
        
        setTimeout(() => {
          createChart('revenueChart', 'line', {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
              label: 'Revenue (‚Çπ)',
              data: [15000, 22000, 18000, 28000, 25000, 32000],
              borderColor: '#14BEF0',
              backgroundColor: 'rgba(20, 190, 240, 0.1)',
              tension: 0.4,
              fill: true
            }]
          }, { responsive: true, maintainAspectRatio: false });

          createChart('demographicsChart', 'doughnut', {
            labels: ['Male', 'Female', 'Other'],
            datasets: [{
              data: [45, 52, 3],
              backgroundColor: ['#14BEF0', '#9B59B6', '#F39C12']
            }]
          }, { responsive: true, maintainAspectRatio: false });

          createChart('appointmentChart', 'bar', {
            labels: ['Consultation', 'Follow-up', 'Emergency'],
            datasets: [{
              label: 'Appointments',
              data: [45, 30, 5],
              backgroundColor: '#3AAA35'
            }]
          }, { responsive: true, maintainAspectRatio: false });

          createChart('paymentChart', 'pie', {
            labels: ['Cash', 'Card', 'UPI', 'Insurance'],
            datasets: [{
              data: [35, 25, 30, 10],
              backgroundColor: ['#3AAA35', '#14BEF0', '#9B59B6', '#F39C12']
            }]
          }, { responsive: true, maintainAspectRatio: false });
        }, 100);
      } else if (currentScreen === 'notifications') {
        content = `
          <div style="padding: 32px;">
            <div style="margin-bottom: 24px;">
              <h1 class="page-title">Notifications</h1>
              <p class="page-subtitle">Patient communication center</p>
            </div>

            <div class="grid grid-cols-3 gap-6 mb-8">
              <div class="stat-card">
                <div class="stat-label">Sent Today</div>
                <div class="stat-number">${DB.notifications.length}</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Pending</div>
                <div class="stat-number">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Delivery Rate</div>
                <div class="stat-number">98%</div>
              </div>
            </div>

            <div class="card">
              <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">Recent Notifications</h3>
              ${DB.notifications.length > 0 ? DB.notifications.map(n => {
                const p = DB.patients.find(pt => pt.id === n.patient_id);
                return `<div style="padding: 16px; background: #F8F9FA; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid var(--primary);">
                  <div style="font-weight: 600; margin-bottom: 4px;">${p.first_name} ${p.last_name}</div>
                  <div style="font-size: 14px; color: var(--text-dark);">${n.message}</div>
                  <div style="font-size: 12px; color: var(--text-light); margin-top: 4px;">${new Date(n.date).toLocaleString()}</div>
                </div>`;
              }).join('') : '<p style="text-align: center; color: var(--text-light); padding: 40px;">No notifications sent yet</p>'}
            </div>
          </div>
        `;
      }

      app.innerHTML = `${header}<div style="display: flex;">${sidebar}<div style="flex: 1; background: #F8F9FA; min-height: calc(100vh - 65px);">${content}</div></div>`;
    }

    // Load data
    const savedPatients = localStorage.getItem('patients');
    const savedAppointments = localStorage.getItem('appointments');
    const savedInvoices = localStorage.getItem('invoices');
    const savedInventory = localStorage.getItem('inventory');
    
    if (savedPatients) DB.patients = JSON.parse(savedPatients);
    if (savedAppointments) DB.appointments = JSON.parse(savedAppointments);
    if (savedInvoices) DB.invoices = JSON.parse(savedInvoices);
    if (savedInventory) DB.inventory = JSON.parse(savedInventory);

    render();
    console.log('‚úÖ MediScript Enterprise - All 5 Features Loaded!');
    console.log('1. Appointment Management ‚úÖ');
    console.log('2. Billing & Invoicing ‚úÖ');
    console.log('3. Analytics Dashboard ‚úÖ');
    console.log('4. Inventory Management ‚úÖ');
    console.log('5. Notification System ‚úÖ');
  </script>
</body>
</html>