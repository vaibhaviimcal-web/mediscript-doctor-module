<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MediScript Pro - Enterprise Healthcare Platform</title>
  <link rel="icon" href="https://nyc3.digitaloceanspaces.com/bhindi-drive/files/cab453ed-7d3e-4dfa-9012-038dbc50c1c5/2025-12-07T15-33-38-867Z-c50befdf-chat-image-1765121618851-0.jpg">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    body.dark { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); }
    
    /* Glass Morphism */
    .glass { 
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    .dark .glass { 
      background: rgba(30, 30, 46, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    /* Modern Cards */
    .card {
      background: white;
      border-radius: 24px;
      padding: 32px;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(0, 0, 0, 0.04);
    }
    .dark .card {
      background: rgba(30, 30, 46, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
    }
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.12);
    }
    
    /* Stat Cards */
    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 20px;
      padding: 28px;
      color: white;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .stat-card::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      transition: all 0.6s;
    }
    .stat-card:hover::before {
      top: -60%;
      right: -60%;
    }
    .stat-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
    }
    .stat-card.green { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    .stat-card.blue { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .stat-card.orange { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    
    /* Buttons */
    .btn {
      padding: 14px 28px;
      border-radius: 14px;
      font-weight: 600;
      font-size: 15px;
      border: none;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    .btn:hover::before {
      width: 300px;
      height: 300px;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
    }
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .btn-success {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
    }
    .btn-danger {
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
      color: white;
    }
    .btn-secondary {
      background: white;
      color: #1f2937;
      border: 2px solid #e5e7eb;
    }
    .dark .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    /* Form Inputs */
    .form-input {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 15px;
      transition: all 0.3s;
      background: white;
    }
    .form-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }
    .dark .form-input {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
      color: white;
    }
    
    /* Sidebar */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(0, 0, 0, 0.06);
      padding: 24px;
      height: 100vh;
      position: sticky;
      top: 0;
      overflow-y: auto;
    }
    .dark .sidebar {
      background: rgba(20, 20, 30, 0.98);
      border-right: 1px solid rgba(255, 255, 255, 0.06);
    }
    
    .nav-item {
      padding: 14px 18px;
      border-radius: 12px;
      margin-bottom: 6px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 500;
      color: #6b7280;
    }
    .nav-item:hover {
      background: rgba(102, 126, 234, 0.08);
      color: #667eea;
      transform: translateX(4px);
    }
    .nav-item.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    .dark .nav-item {
      color: #9ca3af;
    }
    .dark .nav-item:hover {
      background: rgba(102, 126, 234, 0.15);
      color: #a5b4fc;
    }
    
    /* Table */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 8px;
    }
    th {
      background: transparent;
      padding: 16px;
      text-align: left;
      font-weight: 600;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #6b7280;
    }
    td {
      padding: 20px 16px;
      background: white;
      border-top: 1px solid #f3f4f6;
      border-bottom: 1px solid #f3f4f6;
    }
    td:first-child {
      border-left: 1px solid #f3f4f6;
      border-radius: 12px 0 0 12px;
    }
    td:last-child {
      border-right: 1px solid #f3f4f6;
      border-radius: 0 12px 12px 0;
    }
    tr {
      transition: all 0.3s;
    }
    tr:hover td {
      background: #f9fafb;
      transform: scale(1.01);
    }
    .dark td {
      background: rgba(30, 30, 46, 0.6);
      border-color: rgba(255, 255, 255, 0.05);
      color: #e5e7eb;
    }
    .dark tr:hover td {
      background: rgba(40, 40, 56, 0.8);
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s;
    }
    .modal.active { display: flex; }
    .modal-content {
      background: white;
      border-radius: 24px;
      padding: 40px;
      max-width: 1200px;
      max-height: 90vh;
      overflow-y: auto;
      width: 90%;
      box-shadow: 0 24px 64px rgba(0, 0, 0, 0.2);
      animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .dark .modal-content {
      background: #1e1e2e;
      color: white;
    }
    
    /* Badges */
    .badge {
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .badge-success { background: #d1fae5; color: #065f46; }
    .badge-warning { background: #fef3c7; color: #92400e; }
    .badge-purple { background: #ede9fe; color: #6b21a8; }
    .badge-blue { background: #dbeafe; color: #1e40af; }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from { transform: translateY(40px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { 
      background: rgba(102, 126, 234, 0.3);
      border-radius: 10px;
    }
    ::-webkit-scrollbar-thumb:hover { background: rgba(102, 126, 234, 0.5); }
    
    /* Header */
    .header {
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      padding: 20px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .dark .header {
      background: rgba(20, 20, 30, 0.98);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }
    
    /* Chart Container */
    .chart-container {
      position: relative;
      height: 300px;
      margin: 20px 0;
    }
    
    /* Recent Activity */
    .activity-item {
      padding: 16px;
      border-radius: 12px;
      background: #f9fafb;
      margin-bottom: 12px;
      border-left: 4px solid #667eea;
      transition: all 0.3s;
    }
    .activity-item:hover {
      background: #f3f4f6;
      transform: translateX(4px);
    }
    .dark .activity-item {
      background: rgba(255, 255, 255, 0.05);
      border-left-color: #a5b4fc;
    }
    
    /* Loading */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <!-- Patient Modal -->
  <div id="patientModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-8">
        <div>
          <h2 class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">New Patient Registration</h2>
          <p class="text-gray-500 mt-2">Complete patient information in 3 simple steps</p>
        </div>
        <button onclick="closeModal('patientModal')" class="text-4xl text-gray-400 hover:text-gray-600 transition">&times;</button>
      </div>
      <form onsubmit="savePatient(event)" class="space-y-6">
        <div class="grid grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-semibold mb-2">First Name *</label>
            <input type="text" id="patFirstName" class="form-input" required>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Last Name *</label>
            <input type="text" id="patLastName" class="form-input" required>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-6">
          <div>
            <label class="block text-sm font-semibold mb-2">Age *</label>
            <input type="number" id="patAge" class="form-input" required>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Gender *</label>
            <select id="patGender" class="form-input">
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Blood Group</label>
            <select id="patBlood" class="form-input">
              <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
              <option>O+</option><option>O-</option><option>AB+</option><option>AB-</option>
            </select>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-semibold mb-2">Phone *</label>
            <input type="tel" id="patPhone" class="form-input" required>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Email</label>
            <input type="email" id="patEmail" class="form-input">
          </div>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-2">Known Allergies</label>
          <textarea id="patAllergies" class="form-input" rows="2" placeholder="e.g., Penicillin, Peanuts"></textarea>
        </div>
        <div class="flex gap-4 pt-4">
          <button type="submit" class="btn btn-success flex-1">‚úÖ Save Patient</button>
          <button type="button" onclick="closeModal('patientModal')" class="btn btn-secondary">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Examination Modal -->
  <div id="examModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-8">
        <div>
          <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent">Clinical Examination</h2>
          <p class="text-gray-500 mt-2">Record patient examination and prescription</p>
        </div>
        <button onclick="closeModal('examModal')" class="text-4xl text-gray-400 hover:text-gray-600 transition">&times;</button>
      </div>
      <form onsubmit="saveExam(event)" class="space-y-6">
        <div>
          <label class="block text-sm font-semibold mb-2">Select Patient *</label>
          <select id="examPatient" class="form-input" required></select>
        </div>
        <div class="grid grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">BP</label>
            <input type="text" id="vitalBP" class="form-input" placeholder="120/80">
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Temp (¬∞F)</label>
            <input type="text" id="vitalTemp" class="form-input" placeholder="98.6">
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">Pulse</label>
            <input type="text" id="vitalPulse" class="form-input" placeholder="72">
          </div>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-2">Chief Complaint *</label>
          <textarea id="examComplaint" class="form-input" rows="2" required></textarea>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-2">Diagnosis *</label>
          <input type="text" id="examDiagnosis" class="form-input" required>
        </div>
        <div>
          <label class="block text-sm font-semibold mb-2">Treatment Plan</label>
          <textarea id="examTreatment" class="form-input" rows="4"></textarea>
        </div>
        <div class="flex gap-4 pt-4">
          <button type="submit" class="btn btn-success flex-1">‚úÖ Save Examination</button>
          <button type="button" onclick="generatePDF()" class="btn btn-primary">üìÑ Generate PDF</button>
          <button type="button" onclick="closeModal('examModal')" class="btn btn-secondary">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let DB = {
      patients: [
        {id: 'p1', patient_id: 'P001', first_name: 'Rajesh', last_name: 'Kumar', age: 45, gender: 'Male', blood_group: 'O+', phone: '+919876543220'},
        {id: 'p2', patient_id: 'P002', first_name: 'Priya', last_name: 'Sharma', age: 32, gender: 'Female', blood_group: 'A+', phone: '+919876543221'},
        {id: 'p3', patient_id: 'P003', first_name: 'Kumar', last_name: 'Vaibhav', age: 28, gender: 'Male', blood_group: 'A-', phone: '09999456126'}
      ],
      examinations: []
    };

    let currentScreen = 'dashboard';
    let darkMode = localStorage.getItem('darkMode') === 'true';
    let charts = {};

    if (darkMode) document.body.classList.add('dark');

    window.toggleDarkMode = function() {
      darkMode = !darkMode;
      document.body.classList.toggle('dark');
      localStorage.setItem('darkMode', darkMode);
      render();
    };

    window.openModal = function(id) {
      document.getElementById(id).classList.add('active');
      if (id === 'examModal') {
        const select = document.getElementById('examPatient');
        select.innerHTML = DB.patients.map(p => `<option value="${p.id}">${p.patient_id} - ${p.first_name} ${p.last_name}</option>`).join('');
      }
    };

    window.closeModal = function(id) {
      document.getElementById(id).classList.remove('active');
    };

    window.switchScreen = function(screen) {
      currentScreen = screen;
      render();
    };

    window.savePatient = function(e) {
      e.preventDefault();
      const p = {
        id: 'p' + Date.now(),
        patient_id: 'P' + String(DB.patients.length + 1).padStart(3, '0'),
        first_name: document.getElementById('patFirstName').value,
        last_name: document.getElementById('patLastName').value,
        age: parseInt(document.getElementById('patAge').value),
        gender: document.getElementById('patGender').value,
        blood_group: document.getElementById('patBlood').value,
        phone: document.getElementById('patPhone').value,
        email: document.getElementById('patEmail').value,
        allergies: document.getElementById('patAllergies').value
      };
      DB.patients.push(p);
      localStorage.setItem('patients', JSON.stringify(DB.patients));
      closeModal('patientModal');
      alert('‚úÖ Patient registered successfully!');
      render();
    };

    window.saveExam = function(e) {
      e.preventDefault();
      const exam = {
        id: 'e' + Date.now(),
        patient_id: document.getElementById('examPatient').value,
        date: new Date().toISOString().split('T')[0],
        vitals: {
          bp: document.getElementById('vitalBP').value,
          temp: document.getElementById('vitalTemp').value,
          pulse: document.getElementById('vitalPulse').value
        },
        chief_complaint: document.getElementById('examComplaint').value,
        diagnosis: document.getElementById('examDiagnosis').value,
        treatment_plan: document.getElementById('examTreatment').value
      };
      DB.examinations.push(exam);
      localStorage.setItem('examinations', JSON.stringify(DB.examinations));
      closeModal('examModal');
      alert('‚úÖ Examination saved successfully!');
      render();
    };

    window.generatePDF = function() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const patientId = document.getElementById('examPatient').value;
      const patient = DB.patients.find(p => p.id === patientId);
      if (!patient) { alert('Select patient'); return; }

      doc.setFillColor(102, 126, 234);
      doc.rect(0, 0, 210, 50, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(28);
      doc.setFont(undefined, 'bold');
      doc.text('MediScript Pro', 105, 20, { align: 'center' });
      doc.setFontSize(12);
      doc.setFont(undefined, 'normal');
      doc.text('Enterprise Healthcare Platform', 105, 32, { align: 'center' });

      doc.setTextColor(0, 0, 0);
      doc.setFontSize(11);
      doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 65);
      doc.text(`Patient: ${patient.first_name} ${patient.last_name}`, 20, 73);
      doc.text(`Age/Gender: ${patient.age}Y / ${patient.gender}`, 20, 81);

      doc.setFont(undefined, 'bold');
      doc.text('Diagnosis:', 20, 95);
      doc.setFont(undefined, 'normal');
      doc.text(document.getElementById('examDiagnosis').value, 20, 103);

      doc.setFont(undefined, 'bold');
      doc.text('Treatment:', 20, 117);
      doc.setFont(undefined, 'normal');
      const treatment = doc.splitTextToSize(document.getElementById('examTreatment').value, 170);
      doc.text(treatment, 20, 125);

      doc.save(`Prescription_${patient.patient_id}_${new Date().toISOString().split('T')[0]}.pdf`);
      alert('‚úÖ PDF generated!');
    };

    function createChart(canvasId, type, data, options) {
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      if (charts[canvasId]) charts[canvasId].destroy();
      charts[canvasId] = new Chart(ctx, { type, data, options });
    }

    function render() {
      const app = document.getElementById('app');
      
      const header = `<div class="header">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 flex items-center justify-center text-white font-bold text-xl">M</div>
          <div>
            <h1 class="text-xl font-bold">MediScript Pro</h1>
            <p class="text-sm text-gray-500">Enterprise Healthcare Platform</p>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <button onclick="toggleDarkMode()" class="btn btn-secondary">${darkMode ? '‚òÄÔ∏è' : 'üåô'}</button>
          <div class="flex items-center gap-3">
            <div class="text-right">
              <p class="font-semibold">Dr. Rajesh Sharma</p>
              <p class="text-xs text-gray-500">MBBS, MD</p>
            </div>
            <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-600 to-cyan-600 flex items-center justify-center text-white font-bold">RS</div>
          </div>
        </div>
      </div>`;

      const sidebar = `<div class="sidebar">
        <div class="space-y-2">
          <div class="nav-item ${currentScreen === 'dashboard' ? 'active' : ''}" onclick="switchScreen('dashboard')">
            <span class="text-xl">üìä</span>
            <span>Dashboard</span>
          </div>
          <div class="nav-item ${currentScreen === 'patients' ? 'active' : ''}" onclick="switchScreen('patients')">
            <span class="text-xl">üë•</span>
            <span>Patients</span>
          </div>
          <div class="nav-item ${currentScreen === 'examinations' ? 'active' : ''}" onclick="switchScreen('examinations')">
            <span class="text-xl">ü©∫</span>
            <span>Examinations</span>
          </div>
          <div class="nav-item ${currentScreen === 'analytics' ? 'active' : ''}" onclick="switchScreen('analytics')">
            <span class="text-xl">üìà</span>
            <span>Analytics</span>
          </div>
        </div>
        <div class="mt-8 p-4 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600 text-white">
          <p class="font-bold mb-2">üéâ New Features</p>
          <p class="text-xs opacity-90">Enterprise-grade design, charts, and analytics now available!</p>
        </div>
      </div>`;

      let content = '';

      if (currentScreen === 'dashboard') {
        content = `
          <div class="p-8">
            <div class="mb-8">
              <h2 class="text-3xl font-bold mb-2">Welcome back, Dr. Sharma</h2>
              <p class="text-gray-500">Here's what's happening with your practice today</p>
            </div>
            
            <div class="grid grid-cols-3 gap-6 mb-8">
              <div class="stat-card">
                <div class="text-sm opacity-90 mb-2">Total Patients</div>
                <div class="text-4xl font-bold mb-1">${DB.patients.length}</div>
                <div class="text-sm opacity-75">+2 this week</div>
              </div>
              <div class="stat-card green">
                <div class="text-sm opacity-90 mb-2">Examinations</div>
                <div class="text-4xl font-bold mb-1">${DB.examinations.length}</div>
                <div class="text-sm opacity-75">+5 this week</div>
              </div>
              <div class="stat-card blue">
                <div class="text-sm opacity-90 mb-2">Success Rate</div>
                <div class="text-4xl font-bold mb-1">98%</div>
                <div class="text-sm opacity-75">Above average</div>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-6 mb-8">
              <div class="card">
                <h3 class="text-xl font-bold mb-6">Quick Actions</h3>
                <div class="space-y-3">
                  <button onclick="openModal('patientModal')" class="btn btn-success w-full justify-center">
                    <span class="text-xl">+</span>
                    <span>Register New Patient</span>
                  </button>
                  <button onclick="openModal('examModal')" class="btn btn-primary w-full justify-center">
                    <span class="text-xl">ü©∫</span>
                    <span>New Examination</span>
                  </button>
                </div>
              </div>

              <div class="card">
                <h3 class="text-xl font-bold mb-6">Recent Activity</h3>
                <div class="space-y-3">
                  ${DB.examinations.slice(-3).reverse().map(e => {
                    const p = DB.patients.find(pt => pt.id === e.patient_id);
                    return `<div class="activity-item">
                      <div class="font-semibold">${p.first_name} ${p.last_name}</div>
                      <div class="text-sm text-gray-500">${e.diagnosis} ‚Ä¢ ${e.date}</div>
                    </div>`;
                  }).join('') || '<p class="text-gray-500 text-center py-8">No recent activity</p>'}
                </div>
              </div>
            </div>

            <div class="card">
              <h3 class="text-xl font-bold mb-6">Patient Demographics</h3>
              <div class="chart-container">
                <canvas id="demographicsChart"></canvas>
              </div>
            </div>
          </div>
        `;
        
        setTimeout(() => {
          const ageGroups = { '0-20': 0, '21-40': 0, '41-60': 0, '60+': 0 };
          DB.patients.forEach(p => {
            if (p.age <= 20) ageGroups['0-20']++;
            else if (p.age <= 40) ageGroups['21-40']++;
            else if (p.age <= 60) ageGroups['41-60']++;
            else ageGroups['60+']++;
          });
          
          createChart('demographicsChart', 'bar', {
            labels: Object.keys(ageGroups),
            datasets: [{
              label: 'Patients by Age Group',
              data: Object.values(ageGroups),
              backgroundColor: 'rgba(102, 126, 234, 0.8)',
              borderRadius: 8
            }]
          }, {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } }
          });
        }, 100);
      } else if (currentScreen === 'patients') {
        content = `
          <div class="p-8">
            <div class="flex justify-between items-center mb-8">
              <div>
                <h2 class="text-3xl font-bold mb-2">Patient Management</h2>
                <p class="text-gray-500">Manage and view all registered patients</p>
              </div>
              <button onclick="openModal('patientModal')" class="btn btn-success">
                <span class="text-xl">+</span>
                <span>New Patient</span>
              </button>
            </div>

            <div class="card">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Patient Name</th>
                    <th>Age</th>
                    <th>Gender</th>
                    <th>Blood Group</th>
                    <th>Contact</th>
                  </tr>
                </thead>
                <tbody>
                  ${DB.patients.map(p => `
                    <tr>
                      <td><span class="badge badge-purple">${p.patient_id}</span></td>
                      <td class="font-semibold">${p.first_name} ${p.last_name}</td>
                      <td>${p.age} years</td>
                      <td>${p.gender}</td>
                      <td><span class="badge badge-blue">${p.blood_group}</span></td>
                      <td class="text-sm">${p.phone}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </div>
        `;
      } else if (currentScreen === 'examinations') {
        content = `
          <div class="p-8">
            <div class="flex justify-between items-center mb-8">
              <div>
                <h2 class="text-3xl font-bold mb-2">Clinical Examinations</h2>
                <p class="text-gray-500">View and manage patient examinations</p>
              </div>
              <button onclick="openModal('examModal')" class="btn btn-primary">
                <span class="text-xl">ü©∫</span>
                <span>New Examination</span>
              </button>
            </div>

            <div class="card">
              ${DB.examinations.length === 0 ? `
                <div class="text-center py-16">
                  <div class="text-6xl mb-4">ü©∫</div>
                  <h3 class="text-2xl font-bold mb-2">No examinations yet</h3>
                  <p class="text-gray-500 mb-6">Start by creating your first examination</p>
                  <button onclick="openModal('examModal')" class="btn btn-primary">Create Examination</button>
                </div>
              ` : `
                <table>
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Patient</th>
                      <th>Complaint</th>
                      <th>Diagnosis</th>
                      <th>Vitals</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${DB.examinations.map(e => {
                      const p = DB.patients.find(pt => pt.id === e.patient_id);
                      return `
                        <tr>
                          <td>${e.date}</td>
                          <td class="font-semibold">${p.first_name} ${p.last_name}</td>
                          <td class="text-sm">${e.chief_complaint}</td>
                          <td><span class="badge badge-success">${e.diagnosis}</span></td>
                          <td class="text-sm">BP: ${e.vitals.bp || 'N/A'}</td>
                        </tr>
                      `;
                    }).join('')}
                  </tbody>
                </table>
              `}
            </div>
          </div>
        `;
      } else if (currentScreen === 'analytics') {
        content = `
          <div class="p-8">
            <div class="mb-8">
              <h2 class="text-3xl font-bold mb-2">Analytics & Insights</h2>
              <p class="text-gray-500">Track your practice performance</p>
            </div>

            <div class="grid grid-cols-2 gap-6">
              <div class="card">
                <h3 class="text-xl font-bold mb-6">Monthly Examinations</h3>
                <div class="chart-container">
                  <canvas id="monthlyChart"></canvas>
                </div>
              </div>

              <div class="card">
                <h3 class="text-xl font-bold mb-6">Top Diagnoses</h3>
                <div class="chart-container">
                  <canvas id="diagnosisChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        `;
        
        setTimeout(() => {
          createChart('monthlyChart', 'line', {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
              label: 'Examinations',
              data: [12, 19, 15, 25, 22, 30],
              borderColor: 'rgb(102, 126, 234)',
              backgroundColor: 'rgba(102, 126, 234, 0.1)',
              tension: 0.4,
              fill: true
            }]
          }, {
            responsive: true,
            maintainAspectRatio: false
          });

          createChart('diagnosisChart', 'doughnut', {
            labels: ['Fever', 'Cold', 'Gastritis', 'UTI', 'Others'],
            datasets: [{
              data: [30, 25, 20, 15, 10],
              backgroundColor: [
                'rgba(102, 126, 234, 0.8)',
                'rgba(17, 153, 142, 0.8)',
                'rgba(79, 172, 254, 0.8)',
                'rgba(250, 112, 154, 0.8)',
                'rgba(254, 225, 64, 0.8)'
              ]
            }]
          }, {
            responsive: true,
            maintainAspectRatio: false
          });
        }, 100);
      }

      app.innerHTML = `${header}<div class="flex">${sidebar}<div class="flex-1 overflow-y-auto" style="height: calc(100vh - 80px);">${content}</div></div>`;
    }

    // Load data
    const savedPatients = localStorage.getItem('patients');
    const savedExams = localStorage.getItem('examinations');
    if (savedPatients) DB.patients = JSON.parse(savedPatients);
    if (savedExams) DB.examinations = JSON.parse(savedExams);

    render();
    console.log('‚úÖ MediScript Pro - Enterprise Edition Loaded');
  </script>
</body>
</html>